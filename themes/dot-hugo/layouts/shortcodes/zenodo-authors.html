<span id="ph-authors"></span>

<span id="spinner-ph-authors" class="loader-spinner spinner-ph-authors"></span>
<style>
.loader-spinner { width: 20px; height: 20px; margin-bottom: -5px; border: 2px solid rgb(133, 133, 133);
    border-bottom-color: transparent; border-radius: 50%; display: inline-block;
    box-sizing: border-box; animation: rotation 1s linear infinite;}
    @keyframes rotation {0% {transform: rotate(0deg);} 100% {transform: rotate(360deg);}} 
</style>

<script defer>
var randID = makeid(10);

async function renderAuthors() {
  // Wait for data to be loaded
  while (!isDataSaved()) {
    await new Promise(resolve => setTimeout(resolve, 1000));
  }

  const conceptDOI = "{{.Get `doi`}}";
  
  try {
    const authors = await getMetadataFile(conceptDOI, "metadata/authors.json");
    // If it's already parsed (from JSON), use it; otherwise parse it
    const authorsArray = Array.isArray(authors) ? authors : JSON.parse(authors);
    
    let text = "";
    for (let i = 0; i < authorsArray.length; i++) {
      text += authorsArray[i].name + 
        ' <a target="_blank" href="https://orcid.org/' + authorsArray[i].orcid + 
        '"><img style="display: inline-block !important" src="https://info.orcid.org/wp-content/uploads/2019/11/orcid_16x16.png"/></a>, ';
    }
    text = text.slice(0, -2);
    
    // Hide spinners
    const spinners = document.getElementsByClassName("spinner-ph-authors");
    for (let i = 0; i < spinners.length; i++) {
      spinners[i].style.display = "none";
    }
    
    // Update content
    const div = document.getElementById("ph-authors");
    div.id = div.id + "-" + randID;
    div.innerHTML = text;
  } catch (error) {
    console.error("Error loading authors:", error);
    const spinners = document.getElementsByClassName("spinner-ph-authors");
    for (let i = 0; i < spinners.length; i++) {
      spinners[i].style.display = "none";
    }
    const div = document.getElementById("ph-authors");
    div.id = div.id + "-" + randID;
    div.innerHTML = "<em>Error loading authors</em>";
  }
}

renderAuthors();
</script>
